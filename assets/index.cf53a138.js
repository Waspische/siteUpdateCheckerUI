import{p as e,a as t,h as a,r as n,o,c as r,b as s,F as c,d as i,t as d,e as l,w as u,f as p,g as h,i as m,j as f,k as v,v as g,P as y,s as S,l as w,m as V,n as U,q as _,u as D}from"./vendor.dffd3a98.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const n=new URL(e,location),o=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,r)=>{const s=new URL(e,n);if(self[t].moduleMap[s])return a(self[t].moduleMap[s]);const c=new Blob([`import * as m from '${s}';`,`${t}.moduleMap['${s}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(c),onerror(){r(new Error(`Failed to import: ${e}`)),o(i)},onload(){a(self[t].moduleMap[s]),o(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("/assets/");e("data-v-25440e24"),t();const O={name:"SiteDiff",data:()=>({sites:[],selectedSite:null,selectedPrevious:null,selectedCurrent:null,siteUpdates:[]}),mounted(){this.getSites()},methods:{async getSites(){try{const e=await this.axios.get("/sites?size=1000");this.sites=e.data}catch(e){return null}},async getSiteUpdates(){try{const e=await this.axios.get("/siteUpdate/"+this.selectedSite.id);console.log(e.data),this.siteUpdates=e.data.recordUpdateList.map((e=>("REQUEST"===e.watchDTO.type&&(e.currentVersion.content=JSON.stringify(JSON.parse(e.currentVersion.content),null,2),""!==e.previousVersion.content&&(e.previousVersion.content=JSON.stringify(JSON.parse(e.previousVersion.content),null,2))),e))).sort(((e,t)=>e.watchDTO.name>t.watchDTO.name?1:-1))}catch(e){return null}},async updatePrevious(e,t){try{const e=await this.axios.get("/watch-records/"+this.selectedPrevious.id);"REQUEST"===e.data.watch.type&&""!==e.data.content?t.previousVersion.content=JSON.stringify(JSON.parse(e.data.content),null,2):t.previousVersion.content=e.data.content}catch(a){return null}},async updateCurrent(e,t){try{const e=await this.axios.get("/watch-records/"+this.selectedCurrent.id);"REQUEST"===e.data.watch.type&&""!==e.data.content?t.currentVersion.content=JSON.stringify(JSON.parse(e.data.content),null,2):t.currentVersion.content=e.data.content}catch(a){return null}},getLanguage(e){let t="plaintext";switch(e){case"PAGE":t="html";break;case"PAGE_SCRIPT":t="javascript";break;case"REQUEST":t="json";break;default:console.log("Watch type not found")}return t},format_date(e){if(e)return a(String(e)).format("HH:mm DD/MM/YY")}}},C=u("data-v-6f4af7a8");e("data-v-6f4af7a8");const P={key:0},k={key:1},E={key:0},T={key:1};t();const b=C(((e,t,a,u,p,h)=>{const m=n("Dropdown"),f=n("Divider"),v=n("Diff"),g=n("AccordionTab"),y=n("Accordion");return o(),r("div",null,[s(m,{modelValue:p.selectedSite,"onUpdate:modelValue":t[1]||(t[1]=e=>p.selectedSite=e),options:p.sites,onChange:h.getSiteUpdates,optionLabel:"name",placeholder:"Select a site"},null,8,["modelValue","options","onChange"]),s(f),p.siteUpdates?(o(),r(y,{key:0},{default:C((()=>[(o(!0),r(c,null,i(p.siteUpdates,(e=>(o(),r(g,{key:e.watchDTO.id,header:e.watchDTO.name},{default:C((()=>[s(m,{modelValue:p.selectedPrevious,"onUpdate:modelValue":t[2]||(t[2]=e=>p.selectedPrevious=e),options:e.recordLists,onChange:t=>h.updatePrevious(t,e),placeholder:"Previous"},{value:C((e=>[e.value?(o(),r("span",P,d(h.format_date(e.value.date)),1)):(o(),r("span",k,d(e.placeholder),1))])),option:C((e=>[s("span",null,d(h.format_date(e.option.date)),1)])),_:2},1032,["modelValue","options","onChange"]),s(m,{modelValue:p.selectedCurrent,"onUpdate:modelValue":t[3]||(t[3]=e=>p.selectedCurrent=e),options:e.recordLists,onChange:t=>h.updateCurrent(t,e),placeholder:"Current"},{value:C((e=>[e.value?(o(),r("span",E,d(h.format_date(e.value.date)),1)):(o(),r("span",T,d(e.placeholder),1))])),option:C((e=>[s("span",null,d(h.format_date(e.option.date)),1)])),_:2},1032,["modelValue","options","onChange"]),s(v,{language:h.getLanguage(e.watchDTO.type),prev:e.previousVersion.content,current:e.currentVersion.content,class:"p-text-left"},null,8,["language","prev","current"])])),_:2},1032,["header"])))),128))])),_:1})):l("",!0)])}));O.render=b,O.__scopeId="data-v-6f4af7a8";const L={expose:[],setup:e=>(e,t)=>{const a=n("router-view");return o(),r(a)}};const R={name:"SiteDiff",data:()=>({currentWatchId:null,currentWatch:null,selectedPrevious:null,selectedCurrent:null}),mounted(){this.currentWatchId=this.$route.query.id,this.getWatchUpdates()},methods:{async getWatchUpdates(){try{const e=await this.axios.get("/watchUpdate/"+this.currentWatchId);console.log(e.data),"REQUEST"===e.data.watchDTO.type&&(e.data.currentVersion.content=JSON.stringify(JSON.parse(e.data.currentVersion.content),null,2),""!==e.data.previousVersion.content&&(e.data.previousVersion.content=JSON.stringify(JSON.parse(e.data.previousVersion.content),null,2))),this.currentWatch=e.data}catch(e){return null}},async updatePrevious(e,t){try{const e=await this.axios.get("/watch-records/"+this.selectedPrevious.id);"REQUEST"===e.data.watch.type&&""!==e.data.content?t.previousVersion.content=JSON.stringify(JSON.parse(e.data.content),null,2):t.previousVersion.content=e.data.content}catch(a){return null}},async updateCurrent(e,t){try{const e=await this.axios.get("/watch-records/"+this.selectedCurrent.id);"REQUEST"===e.data.watch.type&&""!==e.data.content?t.currentVersion.content=JSON.stringify(JSON.parse(e.data.content),null,2):t.currentVersion.content=e.data.content}catch(a){return null}},getLanguage(e){let t="plaintext";switch(e){case"PAGE":t="html";break;case"PAGE_SCRIPT":t="javascript";break;case"REQUEST":t="json";break;default:console.log("Watch type not found")}return t},format_date(e){if(e)return a(String(e)).format("HH:mm DD/MM/YY")}}},W=u("data-v-7d444176");e("data-v-7d444176");const J={key:0},N={key:0},x={key:1},j={key:0},M={key:1};t();const A=W(((e,t,a,c,i,u)=>{const p=n("Dropdown"),h=n("Diff");return i.currentWatch?(o(),r("div",J,[s(p,{modelValue:i.selectedPrevious,"onUpdate:modelValue":t[1]||(t[1]=e=>i.selectedPrevious=e),options:i.currentWatch.recordLists,onChange:t[2]||(t[2]=e=>u.updatePrevious(e,i.currentWatch)),placeholder:"Previous"},{value:W((e=>[e.value?(o(),r("span",N,d(u.format_date(e.value.date)),1)):(o(),r("span",x,d(e.placeholder),1))])),option:W((e=>[s("span",null,d(u.format_date(e.option.date)),1)])),_:1},8,["modelValue","options"]),s(p,{modelValue:i.selectedCurrent,"onUpdate:modelValue":t[3]||(t[3]=e=>i.selectedCurrent=e),options:i.currentWatch.recordLists,onChange:t[4]||(t[4]=e=>u.updateCurrent(e,i.currentWatch)),placeholder:"Current"},{value:W((e=>[e.value?(o(),r("span",j,d(u.format_date(e.value.date)),1)):(o(),r("span",M,d(e.placeholder),1))])),option:W((e=>[s("span",null,d(u.format_date(e.option.date)),1)])),_:1},8,["modelValue","options"]),s(h,{language:u.getLanguage(i.currentWatch.watchDTO.type),prev:i.currentWatch.previousVersion.content,current:i.currentWatch.currentVersion.content,class:"p-text-left"},null,8,["language","prev","current"])])):l("",!0)}));R.render=A,R.__scopeId="data-v-7d444176";const F={name:"DiffPatcher",components:{SiteDiff:O,FileDiff:R},data:()=>({isFile:!1}),mounted(){void 0!==this.$route.query.id&&(this.isFile=!0)}},I=u("data-v-a2271c28");e("data-v-a2271c28");const Q={key:0},$={key:1};t();const H=I(((e,t,a,c,i,d)=>{const l=n("FileDiff"),u=n("SiteDiff");return o(),r("div",null,[i.isFile?(o(),r("div",Q,[s(l)])):(o(),r("div",$,[s(u)]))])}));F.render=H,F.__scopeId="data-v-a2271c28";const G=[{path:"/",name:"Home",component:F}],Y=p({history:h(),routes:G});const q=m(L);q.use(Y),q.use(f),v.defaults.baseURL="https://earth-2-biomes.herokuapp.com/api/public",q.use(g,v),q.use(y),q.component("Dialog",S),q.component("Button",w),q.component("Accordion",V),q.component("AccordionTab",U),q.component("Dropdown",_),q.component("Divider",D),q.mount("#app");
